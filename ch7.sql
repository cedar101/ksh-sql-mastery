-------------------------------------------------
-- 7장

INSERT INTO city VALUES ('평양','엄청 넓음','꽤 많을걸',0,'조선인민민주주의공화국');

INSERT INTO city ("name", population, metro, region) VALUES ('울산', 114, 1, '경상');
INSERT INTO city ("name", metro, region) VALUES ('삼척', 'n', '강원');

INSERT INTO city (area, population, metro, region) VALUES (456, 123, 'n', '충청');
INSERT INTO city ("name", area, population) VALUES ('의정부', 456,123);

CREATE TABLE tNullable
(
    "name" CHAR(10) NOT NULL,
    age INT
);

CREATE TABLE cityDefault
(
	"name" CHAR(10) PRIMARY KEY,
	area INT NULL ,
	population INT NULL ,
	metro CHAR(1) DEFAULT 'n' NOT NULL,
	region CHAR(6) NOT NULL
);

INSERT INTO cityDefault ("name", area, population, region) VALUES ('진주', 712, 34, '경상');
INSERT INTO cityDefault ("name", area, population, metro, region) VALUES ('인천', 1063, 295, 'y', '경기');

INSERT INTO cityDefault VALUES ('강릉', 1111, 22, '강원');			-- 에러
INSERT INTO cityDefault VALUES ('강릉', 1111, 22, DEFAULT, '강원');	-- 정상 실행

UPDATE city_Default SET metro = DEFAULT WHERE "name" = '인천'

CREATE TABLE check_test
(
	gender CHAR(3) NULL CHECK(gender = '남' OR gender = '여'),
	grade INT NULL CHECK (grade >= 1 AND grade <= 3),
	origin CHAR(3) NULL CHECK(origin IN ('동','서','남','북')),
	"name" CHAR(10) NULL CHECK("name" LIKE '김%')
);

INSERT INTO check_test (gender) VALUES ('여');
INSERT INTO check_test (grade) VALUES (1);
INSERT INTO check_test (origin) VALUES ('동');
INSERT INTO check_test ("name") VALUES ('김좌진');

INSERT INTO check_test (gender) VALUES ('노');
INSERT INTO check_test (grade) VALUES (0);
INSERT INTO check_test (origin) VALUES ('중');
INSERT INTO check_test ("name") VALUES ('청산리');

UPDATE check_test SET grade = 4 WHERE grade IS NOT NULL;

region CHAR(6) NOT NULL CHECK (region IN ('경기', '충청', '강원', '경상', '전라', '제주'))
INSERT INTO city3 VALUES ('울릉',72,1,'n','우산');

INSERT INTO city VALUES ('춘천',1116,27,'n','강원');

CREATE TABLE city
(
	"name" CHAR(10),
	area INT NULL ,
	population INT NULL ,
	metro CHAR(1) NOT NULL,
	region CHAR(6) NOT NULL,
	CONSTRAINT PK_city_"name" PRIMARY KEY("name")
); 

CREATE TABLE city
(
	"name" CHAR(10) PRIMARY KEY,
	region CHAR(6) PRIMARY KEY,
	area INT NULL ,
	population INT NULL ,
	metro CHAR(1) NOT NULL
);

CREATE TABLE city_compo_key
(
	"name" CHAR(10) NOT NULL,
	region CHAR(6) NOT NULL,
	area INT NULL ,
	population INT NULL ,
	metro CHAR(1) NOT NULL,
	CONSTRAINT PK_city_"name"_region PRIMARY KEY ("name", region)
);

INSERT INTO city_compo_key VALUES ('광주', '전라', 123, 456, 'y');
INSERT INTO city_compo_key VALUES ('광주', '경기', 123, 456, 'n');

CREATE TABLE city_unique
(
	"name" CHAR(10) PRIMARY KEY,
	area INT NULL ,
	population INT UNIQUE NULL,
	metro CHAR(1) NOT NULL,
	region CHAR(6) NOT NULL
);

CREATE TABLE city_unique
(
	"name" CHAR(10) PRIMARY KEY,
	area INT NULL ,
	population INT NULL,
	metro CHAR(1) NOT NULL,
	region CHAR(6) NOT NULL,
	CONSTRAINT Unique_city_area_population UNIQUE(area, population)
);

CREATE SEQUENCE seq_sale START WITH 1 INCREMENT BY 1;

CREATE TABLE sale
(
	saleno INT PRIMARY KEY,
	customer VARCHAR(20),
	product VARCHAR(30)
);

INSERT INTO sale VALUES (seq_sale.NEXTVAL, '단군', '지팡이');
INSERT INTO sale VALUES (seq_sale.NEXTVAL, '고주몽', '고등어');

INSERT INTO sale VALUES (NEXT VALUE FOR seq_sale, '단군', '지팡이');
INSERT INTO sale VALUES (NEXT VALUE FOR seq_sale, '고주몽', '고등어');

DELETE FROM sale WHERE saleno = 2;

/* 오라클 : */ INSERT INTO sale VALUES (seq_sale.NEXTVAL, '박혁거세', '계란');
-- MSSQL : INSERT INTO sale VALUES (NEXT VALUE FOR seq_sale, '박혁거세', '계란');

INSERT INTO sale VALUES (2, '고주몽', '고등어');

CREATE TABLE saleSeq
(
	saleno INT GENERATED AS IDENTITY PRIMARY KEY,
	customer VARCHAR(20),
	product VARCHAR(30)
);

INSERT INTO saleSeq (customer, product) VALUES ('단군', '지팡이');
INSERT INTO saleSeq (customer, product) VALUES ('고주몽', '고등어');

saleno INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
saleno INT GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,

INSERT INTO sale (saleno, customer, product) VALUES (5, '단군', '지팡이');	-- 가능
INSERT INTO sale (saleno, customer, product) VALUES (NULL, '고주몽', '고등어');	-- 에러

CREATE TABLE saleId
(
	saleno INT IDENTITY PRIMARY KEY,
	customer VARCHAR(20),
	product VARCHAR(30)
);

INSERT INTO saleId (customer, product) VALUES ('단군', '지팡이');
INSERT INTO saleId (customer, product) VALUES ('고주몽', '고등어');

DELETE FROM saleId WHERE saleno = 2;
INSERT INTO saleId (customer, product) VALUES ('박혁거세', '계란');

INSERT INTO saleId (saleno, customer, product) VALUES (2, '고주몽', '고등어');

SET IDENTITY_INSERT saleId ON;
INSERT INTO saleId (saleno, customer, product) VALUES (2, '고주몽', '고등어');
SET IDENTITY_INSERT saleId OFF;

INSERT INTO saleId VALUES ('왕건', '너구리');

UPDATE saleId SET product = '짜파게티' WHERE saleno = @@IDENTITY;

CREATE TABLE sale
(
	saleno INT AUTO_INCREMENT PRIMARY KEY,
	customer NCHAR(10),
	product NCHAR(30)
);

INSERT INTO sale (customer, product) VALUES ('단군', '지팡이');
INSERT INTO sale (customer, product) VALUES ('고주몽', '고등어');

DELETE FROM sale WHERE saleno = 2;
INSERT INTO sale (customer, product) VALUES ('박혁거세', '계란');

INSERT INTO sale (saleno, customer, product) VALUES (2, '고주몽', '고등어');

ALTER TABLE sale AUTO_INCREMENT = 100;

INSERT INTO sale (customer, product) VALUES ('왕건', '너구리');
UPDATE sale SET product = '짜파게티' WHERE saleno = LAST_INSERT_ID();
